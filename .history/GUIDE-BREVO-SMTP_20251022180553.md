# ğŸ“§ Configuration Brevo (Sendinblue) SMTP - Guide Complet

## âœ… Avantages de Brevo vs Gmail

| CritÃ¨re | Gmail SMTP | Brevo SMTP |
|---------|------------|------------|
| **Fonctionne sur Vercel** | âŒ BloquÃ© par sÃ©curitÃ© | âœ… Parfaitement compatible |
| **Gratuit** | âœ… Oui | âœ… Oui (300 emails/jour) |
| **Configuration** | Complexe (2FA + App Password) | Simple (1 clÃ© API) |
| **IPs serveur Vercel** | âŒ BloquÃ©es | âœ… AutorisÃ©es |
| **DÃ©livrabilitÃ©** | Moyenne | â­ Excellente |
| **Limite emails/jour** | 500 | 300 (gratuit) |
| **Statistiques** | âŒ Non | âœ… Dashboard complet |

---

## ğŸš€ Ã‰tape 1 : CrÃ©er votre compte Brevo (2 minutes)

### 1.1 Inscription

1. Allez sur **https://www.brevo.com/fr/**
2. Cliquez sur **"S'inscrire gratuitement"** (en haut Ã  droite)
3. Remplissez le formulaire :
   - **Email** : `lesptitsloupiotscharentais@gmail.com`
   - **Mot de passe** : CrÃ©ez-en un fort
   - **Nom de l'entreprise** : "Les Ptits Loupiots Charentais"
   - **Site web** : `https://lesptitsloupiotscharentais.fr`
4. Cliquez sur **"CrÃ©er mon compte"**

### 1.2 Validation email

1. Allez dans votre boÃ®te Gmail `lesptitsloupiotscharentais@gmail.com`
2. Ouvrez l'email de Brevo : "Confirmez votre adresse email"
3. Cliquez sur le bouton de validation
4. Vous serez redirigÃ© vers le dashboard Brevo

---

## ğŸ”‘ Ã‰tape 2 : Obtenir votre clÃ© SMTP (3 minutes)

### 2.1 AccÃ©der aux paramÃ¨tres SMTP

1. Une fois connectÃ© Ã  Brevo, cliquez sur votre **nom/avatar** (en haut Ã  droite)
2. Dans le menu dÃ©roulant, cliquez sur **"ParamÃ¨tres"**
3. Dans le menu de gauche, cherchez **"SMTP & API"**
4. Cliquez sur **"SMTP"** (premier onglet)

### 2.2 CrÃ©er une clÃ© SMTP

Vous verrez les informations suivantes :

```
Serveur SMTP : smtp-relay.brevo.com
Port : 587
Login : lesptitsloupiotscharentais@gmail.com
Mot de passe SMTP : [Ã€ crÃ©er]
```

1. Cliquez sur le bouton **"CrÃ©er une nouvelle clÃ© SMTP"**
2. Dans la popup :
   - **Nom** : "Site Web Les Ptits Loupiots"
   - Cliquez sur **"GÃ©nÃ©rer"**
3. âš ï¸ **IMPORTANT** : Une clÃ© apparaÃ®t (exemple : `xkeysib-a1b2c3d4...`)
   - **COPIEZ-LA IMMÃ‰DIATEMENT** ğŸ“‹
   - Vous ne pourrez **PLUS JAMAIS** la revoir aprÃ¨s avoir fermÃ© cette fenÃªtre !
   - Si vous la perdez, vous devrez en crÃ©er une nouvelle

### 2.3 OÃ¹ coller la clÃ© ?

**Format de la clÃ© :**
```
xkeysib-a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6
```
(environ 64 caractÃ¨res)

---

## ğŸ’» Ã‰tape 3 : Configuration locale (.env.local)

### 3.1 Ouvrir le fichier

Ouvrez le fichier `.env.local` Ã  la racine de votre projet.

### 3.2 Remplacer la clÃ©

Remplacez :
```bash
BREVO_SMTP_KEY=votre_cle_smtp_brevo_ici
```

Par votre vraie clÃ© (exemple) :
```bash
BREVO_SMTP_KEY=xkeysib-a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6
```

### 3.3 Fichier final

Votre `.env.local` doit ressembler Ã  Ã§a :
```bash
# Configuration Brevo (Sendinblue) SMTP
BREVO_SMTP_USER=lesptitsloupiotscharentais@gmail.com
BREVO_SMTP_KEY=xkeysib-a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6
```

---

## â˜ï¸ Ã‰tape 4 : Configuration Vercel (Production)

### 4.1 Supprimer les anciennes variables Gmail

1. Allez sur https://vercel.com/dashboard
2. SÃ©lectionnez votre projet **lesptitsloupiotscharentais**
3. Cliquez sur **Settings** (menu du haut)
4. Dans le menu de gauche : **Environment Variables**
5. **Supprimez** ces variables (si elles existent) :
   - âŒ `GMAIL_USER` â†’ Cliquez sur les 3 points â†’ Delete
   - âŒ `GMAIL_APP_PASSWORD` â†’ Cliquez sur les 3 points â†’ Delete

### 4.2 Ajouter les variables Brevo

**Variable 1 :**
```
Key (Name):   BREVO_SMTP_USER
Value:        lesptitsloupiotscharentais@gmail.com
```
Environnements : âœ… **Production** âœ… **Preview** âœ… **Development**

Cliquez sur **"Add"** ou **"Save"**

---

**Variable 2 :**
```
Key (Name):   BREVO_SMTP_KEY
Value:        xkeysib-a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6
```
Environnements : âœ… **Production** âœ… **Preview** âœ… **Development**

Cliquez sur **"Add"** ou **"Save"**

âš ï¸ **Important** : Cochez bien les 3 environnements (Production, Preview, Development)

---

## ğŸš€ Ã‰tape 5 : DÃ©ployer les changements

### 5.1 VÃ©rifier les modifications

```bash
git status
```

Vous devriez voir :
- `modified:   src/app/api/contact/route.ts`
- `modified:   .env.local` (ne sera PAS poussÃ© sur Git, c'est normal)

### 5.2 Commit et push

```bash
git add .
git commit -m "Migration Gmail vers Brevo SMTP pour production Vercel"
git push
```

### 5.3 Attendre le dÃ©ploiement

1. Allez sur https://vercel.com/dashboard
2. Vous verrez un dÃ©ploiement en cours (Building...)
3. Attendez 2-3 minutes
4. Status : âœ… **Ready**

---

## âœ… Ã‰tape 6 : Tester l'envoi d'email

### 6.1 Test en production

1. Allez sur **https://lesptitsloupiotscharentais.fr/contact**
2. Remplissez le formulaire :
   - Nom : Test Brevo
   - Email : votre.email@test.com
   - Sujet : Test envoi Brevo
   - Message : Ceci est un test d'envoi via Brevo SMTP
3. Cliquez sur **"Envoyer mon message"**
4. Vous devriez voir : âœ… **"Message envoyÃ© avec succÃ¨s !"**

### 6.2 VÃ©rifier la rÃ©ception

1. Ouvrez votre Gmail **lesptitsloupiotscharentais@gmail.com**
2. L'email devrait arriver en **moins de 10 secondes** âš¡
3. VÃ©rifiez aussi le **dossier Spam** (parfois au dÃ©but)
4. Si c'est dans les spams, cliquez sur **"Non spam"**

### 6.3 VÃ©rifier dans Brevo

1. Retournez sur https://app.brevo.com
2. Menu de gauche : **"Statistiques"** â†’ **"Email"**
3. Vous verrez :
   - âœ… Emails envoyÃ©s : 1
   - âœ… Emails dÃ©livrÃ©s : 1
   - âœ… Taux d'ouverture : (une fois ouvert)

---

## ğŸ¯ Statistiques Brevo (Dashboard)

Brevo vous offre un dashboard avec :
- ğŸ“Š **Nombre d'emails envoyÃ©s** (quota : 300/jour gratuit)
- âœ… **Taux de dÃ©livrabilitÃ©** (% d'emails bien reÃ§us)
- ğŸ“§ **Taux d'ouverture** (qui ouvre vos emails)
- ğŸ”— **Clics sur liens** (si vous mettez des liens)
- âŒ **Bounces** (emails rejetÃ©s)
- ğŸ“ **Historique complet** de tous les emails

Pour y accÃ©der :
- https://app.brevo.com â†’ **"Statistiques"** â†’ **"Email"**

---

## ğŸ”§ DÃ©pannage

### ProblÃ¨me : "Erreur lors de l'envoi"

**Solutions :**
1. VÃ©rifiez que la clÃ© SMTP est bien copiÃ©e **sans espaces** ni retours Ã  la ligne
2. VÃ©rifiez que les variables sont bien sur Vercel (Settings â†’ Environment Variables)
3. Refaites un dÃ©ploiement : `git commit --allow-empty -m "Redeploy" && git push`
4. Attendez 2-3 min aprÃ¨s l'ajout des variables sur Vercel

### ProblÃ¨me : "Invalid credentials"

**Cause :** ClÃ© SMTP incorrecte

**Solution :**
1. Retournez sur Brevo â†’ ParamÃ¨tres â†’ SMTP & API
2. Supprimez l'ancienne clÃ© SMTP
3. CrÃ©ez une nouvelle clÃ©
4. Mettez Ã  jour `.env.local` ET Vercel avec la nouvelle clÃ©

### ProblÃ¨me : Email dans les spams

**Normal** au dÃ©but. Pour amÃ©liorer :
1. Marquez l'email comme **"Non spam"** dans Gmail
2. Ajoutez `lesptitsloupiotscharentais@gmail.com` dans vos contacts
3. Ouvrez plusieurs emails â†’ Gmail apprendra que c'est lÃ©gitime
4. **Optionnel (avancÃ©)** : Configurez SPF/DKIM sur votre domaine

### ProblÃ¨me : Quota dÃ©passÃ© (300 emails)

**Si vous dÃ©passez 300 emails/jour :**
1. Attendez le lendemain (quota se rÃ©initialise Ã  minuit)
2. **OU** passez au plan payant Brevo (9â‚¬/mois pour 5 000 emails)
3. **OU** utilisez plusieurs comptes Brevo (pas recommandÃ©)

---

## ğŸ“Š Limites du plan gratuit Brevo

| FonctionnalitÃ© | Plan Gratuit |
|----------------|--------------|
| Emails/jour | **300** |
| Emails/mois | **9 000** |
| Contacts | **IllimitÃ©** |
| Templates | **IllimitÃ©** |
| SMTP | âœ… Oui |
| API | âœ… Oui |
| Statistiques | âœ… ComplÃ¨tes |
| Support | Email (48h) |
| Logo Brevo | âš ï¸ Oui (en bas des emails) |

ğŸ’¡ **Pour votre usage** (formulaire de contact) : 300 emails/jour est **largement suffisant** !

---

## âœ… Checklist finale

- [ ] Compte Brevo crÃ©Ã© et email validÃ©
- [ ] ClÃ© SMTP gÃ©nÃ©rÃ©e et copiÃ©e
- [ ] `.env.local` mis Ã  jour avec la clÃ©
- [ ] Variables ajoutÃ©es sur Vercel (BREVO_SMTP_USER + BREVO_SMTP_KEY)
- [ ] Anciennes variables Gmail supprimÃ©es de Vercel
- [ ] Code poussÃ© sur GitHub (`git push`)
- [ ] DÃ©ploiement Vercel terminÃ© (status Ready)
- [ ] Test d'envoi rÃ©ussi depuis le formulaire
- [ ] Email reÃ§u dans Gmail

---

## ğŸ‰ RÃ©sultat attendu

Une fois tout configurÃ© :
1. Visiteur remplit le formulaire sur `/contact`
2. Email envoyÃ© via **Brevo SMTP** en **< 2 secondes**
3. Email reÃ§u dans **lesptitsloupiotscharentais@gmail.com** en **< 10 secondes**
4. Vous pouvez **rÃ©pondre directement** via Gmail (grÃ¢ce au `replyTo`)
5. Statistiques visibles sur **Brevo Dashboard**

---

**Besoin d'aide ?** Contactez-moi Ã  chaque Ã©tape !

ğŸ“§ **Service email dÃ©sormais fiable et professionnel !** âœ…
